@use "sass:color";
@use "../base/variables";
@use "../base/colors";
@use "../base/typography";

.form {
	display: grid;
	row-gap: variables.$size-medium;
	max-width: 25rem;
	margin: 0 auto;
	padding: variables.$size-large;

	background-color: colors.$neutral-lighter;
	border: variables.$border solid colors.$primary-lighter;
	border-radius: variables.$border-radius;
	box-shadow: variables.$shadow-light;

	&__group {
		display: grid;
		row-gap: variables.$size-small;
	}

	&__header {
		align-items: center;
		gap: variables.$size-small;
		padding: variables.$size-medium;
		color: colors.$primary-main;

		h1 {
			@extend %heading-triple-extra-large;

			justify-self: center;
			text-align: center;
		}
	}

	&__figure {
		display: grid;
		overflow: hidden;

		align-items: center;
		justify-items: center;

		padding: variables.$size-medium;
		min-height: 0;

		background-color: colors.$neutral-lightest;
		border-radius: variables.$border-radius;

		img {
			display: block;

			width: 80%;
			height: 100%;

			object-fit: cover;
		}
	}

	&__label {
		@extend %text-medium;

		&--visually-hidden {
			position: absolute !important;
			width: 1px;
			height: 1px;
			padding: 0;
			margin: -1px;
			overflow: hidden;
			clip: rect(0, 0, 0, 0);
			white-space: nowrap;
			border: 0;
		}
	}

	&__control {
		display: block;
		width: 100%;
		padding: 0.75rem 1rem;

		font: inherit;
		color: colors.$neutral-darker;
		background-color: colors.$neutral-lightest;

		border: variables.$border solid colors.$primary-lighter;
		border-radius: variables.$border-radius;

		transition: border-color 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;

		@extend %text-small;

		&::placeholder {
			color: colors.$neutral-dark;
		}

		&:focus {
			outline: 1px solid colors.$primary-main;
			outline-offset: 1px;
			box-shadow: 0 0 0 2px rgba(colors.$primary-main, 0.20);
		}

		&:disabled {
			background-color: colors.$neutral-light;
			color: colors.$neutral-dark;
			cursor: not-allowed;
			opacity: 0.8;
		}

		&:read-only {
			background-color: colors.$neutral-light;
		}

		&.is-invalid {
			border-color: colors.$danger-main;
			box-shadow: 0 0 0 2px rgba(colors.$danger-main, 0.12);
		}

		&.is-valid {
			border-color: colors.$success-main;
			box-shadow: 0 0 0 2px rgba(colors.$success-darker, 0.12);
		}
	}

	// /* Afins natius amb la classe aplicada */
	// input[type="text"].form__control,
	// input[type="email"].form__control,
	// input[type="password"].form__control,
	// input[type="number"].form__control,
	// input[type="date"].form__control,
	// input[type="search"].form__control,
	// select.form__control,
	// textarea.form__control {
	// 	/* hereten de &__control */
	// }

	/* Select */
	input.form__control {
		padding-right: 2rem;
		background-image: none;
	}

	/* Select */
	select.form__control {
		padding-right: 2rem;
		background-image: none;
	}

	/* Textarea */
	textarea.form__control {
		min-height: 8rem;
		resize: vertical;
	}

	/* -------- Ajuda i error -------- */
	&__hint {
		font-size: 0.875rem;
		color: colors.$neutral-dark;
	}

	&__error {
		font-size: 0.875rem;
		color: colors.$danger-dark;

		&--global {
			margin-top: variables.$size-small;
		}
	}

	/* -------- Checkbox / Radio -------- */
	&__check {
		display: grid;
		grid-auto-flow: column;
		align-items: center;
		justify-content: start;
		column-gap: variables.$size-small;

		&-input {
			width: 1rem;
			height: 1rem;
			margin: 0;

			border: variables.$border solid colors.$primary-main;
			border-radius: 0.25rem;
			appearance: none;
			display: grid;
			place-content: center;
			background-color: colors.$neutral-lightest;
			cursor: pointer;

			transition: background 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;

			&:focus {
				outline: 2px solid colors.$primary-main;
				outline-offset: 2px;
			}

			&:checked {
				background-color: colors.$primary-main;
				border-color: colors.$primary-main;
			}

			&:checked::after {
				content: "";
				width: 0.5rem;
				height: 0.5rem;
				border-radius: 0.125rem;
				background-color: colors.$neutral-lightest;
			}

			&:disabled {
				background-color: colors.$neutral-light;
				border-color: colors.$neutral-main;
				cursor: not-allowed;
			}

			/* Radio circular */
			&[type="radio"] {
				border-radius: 50%;

				&:checked::after {
					border-radius: 50%;
				}
			}
		}

		&-label {
			color: colors.$neutral-darker;
			user-select: none;
			cursor: pointer;
		}
	}

	&__alert {
		display: grid;
		grid-template-columns: 1fr auto;
		/* text + (opcional) bot√≥ tancar */
		align-items: start;
		gap: variables.$size-small;

		padding: variables.$size-medium;
		border-radius: variables.$border-radius;
		border: variables.$border solid colors.$primary-main;
		/* default, sobreescrit per variants */
		background-color: colors.$neutral-lightest;

		font-size: 0.95rem;
		line-height: 1.35;

		&--error {
			border-color: colors.$danger-main;
			background-color: colors.$danger-lighter;
			/* suau */
			color: colors.$danger-dark;
		}

		&__text {
			margin: 0;
		}

		&__close {
			border: variables.$border solid transparent;
			background-color: transparent;
			border-radius: variables.$border-radius;
			padding: variables.$size-extra-small variables.$size-small;
			line-height: 1;
		}
	}

	/* -------- Accions -------- */
	&__actions {
		display: grid;
		grid-auto-flow: column;
		justify-content: center;
		gap: variables.$size-large;
		margin-top: variables.$size-small;

		.button {
			min-width: 10rem;
		}
	}
}
